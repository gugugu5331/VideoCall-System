# ä¼šè®®ç³»ç»Ÿæ¶æ„è®¾è®¡

## ç³»ç»Ÿæ¦‚è¿°

åŸºäºç°æœ‰Edge-LLM-InfraåŸºç¡€è®¾æ–½æ„å»ºçš„ä¼ä¸šçº§ä¼šè®®ç³»ç»Ÿï¼Œé‡‡ç”¨SFUæ¶æ„å®ç°ä½å»¶è¿Ÿã€é«˜å®‰å…¨æ€§çš„éŸ³è§†é¢‘é€šè¯ï¼Œé›†æˆåˆ†å¸ƒå¼AIæ¨ç†æœåŠ¡ã€‚

## æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
å®¢æˆ·ç«¯å±‚
â”œâ”€â”€ Qt6 æ¡Œé¢å®¢æˆ·ç«¯
â”œâ”€â”€ Web æµè§ˆå™¨å®¢æˆ·ç«¯
â””â”€â”€ ç§»åŠ¨ç«¯å®¢æˆ·ç«¯

ç½‘å…³å±‚
â”œâ”€â”€ Nginx è´Ÿè½½å‡è¡¡
â””â”€â”€ API ç½‘å…³

å¾®æœåŠ¡å±‚
â”œâ”€â”€ ç”¨æˆ·æœåŠ¡ (User Service)
â”œâ”€â”€ ä¼šè®®æœåŠ¡ (Meeting Service)  
â”œâ”€â”€ ä¿¡ä»¤æœåŠ¡ (Signaling Service)
â”œâ”€â”€ åª’ä½“æœåŠ¡ (Media Service - SFU)
â”œâ”€â”€ AIæ£€æµ‹æœåŠ¡ (AI Detection Service)
â””â”€â”€ é€šçŸ¥æœåŠ¡ (Notification Service)

AIæ¨ç†å±‚ (åŸºäºEdge-LLM-Infra)
â”œâ”€â”€ Edge-Model-Infra
â”œâ”€â”€ æ¨¡å‹ç®¡ç†å™¨
â””â”€â”€ æ¨ç†èŠ‚ç‚¹é›†ç¾¤

æ•°æ®å±‚
â”œâ”€â”€ PostgreSQL (ä¸»æ•°æ®åº“)
â”œâ”€â”€ Redis (ç¼“å­˜)
â”œâ”€â”€ MongoDB (æ–‡æ¡£å­˜å‚¨)
â””â”€â”€ MinIO (å¯¹è±¡å­˜å‚¨)
```

### æŠ€æœ¯æ ˆ

- **åç«¯**: Go (Gin + GORM) + gRPC
- **å‰ç«¯**: Qt6 + Web (React/Vue)
- **é€šä¿¡**: HTTP + WebRTC (SFUæ¶æ„)
- **æ•°æ®åº“**: PostgreSQL + Redis + MongoDB + MinIO
- **AIæ¨ç†**: åŸºäºç°æœ‰Edge-LLM-Infra
- **éŸ³è§†é¢‘**: FFmpeg + OpenCV + OpenGL
- **éƒ¨ç½²**: Docker + Nginx

## é¡¹ç›®ç»“æ„

```
meeting-system/
â”œâ”€â”€ backend/                    # åç«¯å¾®æœåŠ¡
â”‚   â”œâ”€â”€ api-gateway/           # APIç½‘å…³
â”‚   â”œâ”€â”€ user-service/          # ç”¨æˆ·æœåŠ¡
â”‚   â”œâ”€â”€ meeting-service/       # ä¼šè®®æœåŠ¡
â”‚   â”œâ”€â”€ signaling-service/     # ä¿¡ä»¤æœåŠ¡
â”‚   â”œâ”€â”€ media-service/         # åª’ä½“æœåŠ¡(SFU)
â”‚   â”œâ”€â”€ ai-service/            # AIæ£€æµ‹æœåŠ¡
â”‚   â”œâ”€â”€ notification-service/  # é€šçŸ¥æœåŠ¡
â”‚   â”œâ”€â”€ shared/               # å…±äº«åº“
â”‚   â””â”€â”€ scripts/              # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ frontend/                  # å‰ç«¯
â”‚   â”œâ”€â”€ web-admin/            # Webç®¡ç†ç•Œé¢
â”‚   â”œâ”€â”€ web-client/           # Webå®¢æˆ·ç«¯
â”‚   â””â”€â”€ qt-client/            # Qtæ¡Œé¢å®¢æˆ·ç«¯
â”œâ”€â”€ deployment/               # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ docker/              # Dockeré…ç½®
â”‚   â”œâ”€â”€ nginx/               # Nginxé…ç½®
â”‚   â””â”€â”€ k8s/                 # Kubernetesé…ç½®
â”œâ”€â”€ docs/                    # æ–‡æ¡£
â””â”€â”€ scripts/                 # æ„å»ºè„šæœ¬
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ·ç®¡ç†
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- JWTè®¤è¯
- æƒé™ç®¡ç†
- ç”¨æˆ·èµ„æ–™ç®¡ç†

### 2. ä¼šè®®ç®¡ç†
- ä¼šè®®åˆ›å»º/åˆ é™¤
- ä¼šè®®å®¤ç®¡ç†
- å‚ä¸è€…ç®¡ç†
- ä¼šè®®å½•åˆ¶

### 3. éŸ³è§†é¢‘é€šä¿¡
- SFUæ¶æ„åª’ä½“è·¯ç”±
- WebRTCä¿¡ä»¤å¤„ç†
- éŸ³è§†é¢‘ç¼–è§£ç 
- å±å¹•å…±äº«

### 4. AIåŠŸèƒ½é›†æˆ
- å®æ—¶è¯­éŸ³è¯†åˆ«
- æƒ…ç»ªè¯†åˆ«
- éŸ³è§†é¢‘è´¨é‡ä¼˜åŒ–
- æ™ºèƒ½é™å™ª

### 5. å®æ—¶é€šä¿¡
- æ–‡å­—èŠå¤©
- æ–‡ä»¶å…±äº«
- ç™½æ¿åä½œ
- å®æ—¶é€šçŸ¥

## ä¸Edge-LLM-Infraé›†æˆæ¶æ„

### é›†æˆç­–ç•¥

ä¼šè®®ç³»ç»Ÿé‡‡ç”¨**æ··åˆæ¶æ„**è®¾è®¡ï¼Œå……åˆ†åˆ©ç”¨Edge-LLM-Infraçš„åˆ†å¸ƒå¼AIæ¨ç†èƒ½åŠ›ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¼šè®®ç³»ç»Ÿæ•´ä½“æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Goå¾®æœåŠ¡å±‚ (ä¸šåŠ¡é€»è¾‘)                                          â”‚
â”‚  â”œâ”€â”€ APIç½‘å…³ â”€â”€â”                                             â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·æœåŠ¡   â”‚                                             â”‚
â”‚  â”œâ”€â”€ ä¼šè®®æœåŠ¡   â”œâ”€â”€â”€ ZMQ/TCPåè®®ç½‘å…³ â”€â”€â”                        â”‚
â”‚  â”œâ”€â”€ ä¿¡ä»¤æœåŠ¡   â”‚                     â”‚                      â”‚
â”‚  â”œâ”€â”€ åª’ä½“æœåŠ¡   â”‚                     â”‚                      â”‚
â”‚  â””â”€â”€ é€šçŸ¥æœåŠ¡ â”€â”€â”˜                     â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Edge-LLM-Infra (AIæ¨ç†åŸºç¡€è®¾æ–½)         â”‚                      â”‚
â”‚  â”œâ”€â”€ unit-manager (å…¨å±€èŠ‚ç‚¹ç®¡ç†)        â”‚                      â”‚
â”‚  â”œâ”€â”€ ä¼šè®®AIèŠ‚ç‚¹ (ç»§æ‰¿StackFlow)         â”‚                      â”‚
â”‚  â”‚   â”œâ”€â”€ è¯­éŸ³è¯†åˆ«ä»»åŠ¡                  â”‚                      â”‚
â”‚  â”‚   â”œâ”€â”€ æƒ…ç»ªè¯†åˆ«ä»»åŠ¡                  â”‚                      â”‚
â”‚  â”‚   â”œâ”€â”€ éŸ³é¢‘é™å™ªä»»åŠ¡                  â”‚                      â”‚
â”‚  â”‚   â””â”€â”€ è§†é¢‘å¢å¼ºä»»åŠ¡                  â”‚                      â”‚
â”‚  â””â”€â”€ æ¨ç†èŠ‚ç‚¹é›†ç¾¤                      â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                   æ ‡å‡†åŒ–JSONåè®®
                                   (request_id, work_id,
                                    object, data, error)
```

### æ ¸å¿ƒé›†æˆç»„ä»¶

#### 1. ä¼šè®®AIæ¨ç†èŠ‚ç‚¹ (C++)
åŸºäºStackFlowæ¡†æ¶å®ç°çš„ä¸“ç”¨AIæ¨ç†èŠ‚ç‚¹ï¼š

```cpp
class MeetingAINode : public StackFlow {
public:
    // ç»§æ‰¿StackFlowçš„æ ‡å‡†æ¥å£
    int setup(const std::string& work_id, const std::string& object, const std::string& data) override;
    int exit(const std::string& work_id, const std::string& object, const std::string& data) override;

    // ä¼šè®®ä¸“ç”¨AIä»»åŠ¡
    void processSpeechRecognition(const std::string& audio_data);
    void processEmotionDetection(const std::string& video_frame);
    void processAudioDenoising(const std::string& audio_stream);
    void processVideoEnhancement(const std::string& video_stream);
};
```

#### 2. Go-ZMQæ¡¥æ¥åº“
å®ç°Goè¯­è¨€ä¸ZMQçš„é€šä¿¡æ¡¥æ¥ï¼š

```go
package zmqbridge

type ZMQClient struct {
    endpoint string
    timeout  time.Duration
}

// è°ƒç”¨Edge-LLM-Infraçš„AIæ¨ç†æœåŠ¡
func (c *ZMQClient) CallAIService(request AIRequest) (*AIResponse, error)

// æ ‡å‡†åŒ–æ¶ˆæ¯æ ¼å¼
type AIRequest struct {
    RequestID string `json:"request_id"`
    WorkID    string `json:"work_id"`
    Object    string `json:"object"`
    Data      string `json:"data"`
}
```

#### 3. åè®®è½¬æ¢ç½‘å…³
åˆ©ç”¨unit-managerçš„å¤šåè®®ç½‘å…³èƒ½åŠ›ï¼š

- **TCPæ¥å£**: Goå¾®æœåŠ¡é€šè¿‡TCPè¿æ¥
- **ZMQè½¬æ¢**: è‡ªåŠ¨è½¬æ¢ä¸ºå†…éƒ¨ZMQåè®®
- **è´Ÿè½½å‡è¡¡**: è‡ªåŠ¨åˆ†å‘åˆ°å¯ç”¨çš„AIæ¨ç†èŠ‚ç‚¹

### é›†æˆé€šä¿¡æµç¨‹

1. **æœåŠ¡æ³¨å†Œ**:
   ```
   ä¼šè®®AIèŠ‚ç‚¹ â†’ unit-manager â†’ æœåŠ¡æ³¨å†Œè¡¨
   ```

2. **AIæ¨ç†è¯·æ±‚**:
   ```
   Goå¾®æœåŠ¡ â†’ TCPç½‘å…³ â†’ ZMQåè®®è½¬æ¢ â†’ ä¼šè®®AIèŠ‚ç‚¹ â†’ æ¨ç†ç»“æœè¿”å›
   ```

3. **å®æ—¶æµå¤„ç†**:
   ```
   åª’ä½“æµ â†’ Goåª’ä½“æœåŠ¡ â†’ AIæ¨ç†è¯·æ±‚ â†’ Edge-LLM-Infra â†’ å¤„ç†ç»“æœ â†’ å®¢æˆ·ç«¯
   ```

### æ¶ˆæ¯åè®®æ ‡å‡†

å¤ç”¨Edge-LLM-Infraçš„æ ‡å‡†åŒ–JSONåè®®ï¼š

```json
{
  "request_id": "req_123456",
  "work_id": "meeting_ai_001",
  "object": "speech_recognition",
  "data": {
    "audio_format": "pcm",
    "sample_rate": 16000,
    "audio_data": "base64_encoded_audio"
  },
  "error": null
}
```

### AIåŠŸèƒ½æ˜ å°„

| ä¼šè®®åŠŸèƒ½ | Edge-LLM-Infraä»»åŠ¡ç±»å‹ | å¤„ç†èŠ‚ç‚¹ |
|---------|----------------------|---------|
| å®æ—¶è¯­éŸ³è¯†åˆ« | speech_recognition | è¯­éŸ³è¯†åˆ«èŠ‚ç‚¹ |
| æƒ…ç»ªè¯†åˆ« | emotion_detection | è§†è§‰åˆ†æèŠ‚ç‚¹ |
| æ™ºèƒ½é™å™ª | audio_denoising | éŸ³é¢‘å¤„ç†èŠ‚ç‚¹ |
| è§†é¢‘å¢å¼º | video_enhancement | è§†é¢‘å¤„ç†èŠ‚ç‚¹ |
| è¯­éŸ³åˆæˆ | text_to_speech | è¯­éŸ³åˆæˆèŠ‚ç‚¹ |

## éƒ¨ç½²æ–¹æ¡ˆ

### å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨åŸºç¡€æœåŠ¡
docker-compose -f deployment/docker/dev.yml up -d

# å¯åŠ¨å¾®æœåŠ¡
./scripts/start-dev.sh
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨Kuberneteséƒ¨ç½²
kubectl apply -f deployment/k8s/
```

## å¼€å‘è®¡åˆ’

1. âœ… æ¶æ„è®¾è®¡ä¸è§„åˆ’
2. ğŸ”„ åç«¯å¾®æœåŠ¡åŸºç¡€æ¡†æ¶
3. â³ æ•°æ®åº“å±‚è®¾è®¡ä¸å®ç°
4. â³ æ ¸å¿ƒå¾®æœåŠ¡å®ç°
5. â³ SFUåª’ä½“æœåŠ¡å®ç°
6. â³ AIæœåŠ¡é›†æˆ
7. â³ å‰ç«¯å¼€å‘
8. â³ ç³»ç»Ÿé›†æˆæµ‹è¯•
9. â³ å®¹å™¨åŒ–éƒ¨ç½²

## æ€§èƒ½æŒ‡æ ‡

- **å»¶è¿Ÿ**: < 100ms (éŸ³è§†é¢‘)
- **å¹¶å‘**: æ”¯æŒ1000+å¹¶å‘ä¼šè®®
- **å¯ç”¨æ€§**: 99.9%
- **æ‰©å±•æ€§**: æ°´å¹³æ‰©å±•æ”¯æŒ
